webpackJsonp([5081115688789],{469:function(e,n){e.exports={data:{markdownRemark:{html:"<h2>Links</h2>\n<h2>Project Reactor concepts</h2>",frontmatter:{title:"Project Reactor",date:"October 20, 2021",path:"/project-reactor",tags:["java","project reactor"],excerpt:""}}},pathContext:{prev:{html:'<h2>Links</h2>\n<ul>\n<li><a href="https://cheatography.com/tasjaevan/cheat-sheets/redis/">Cheat sheet</a>  </li>\n<li><a href="https://cheatography.com/tasjaevan/cheat-sheets/redis/">Redis commands</a></li>\n</ul>\n<h2>Redis configuration</h2>\n<p><a href="https://redis.io/topics/notifications#configuration">Documentation on configuration</a></p>\n<p>Command to get the expired events from Redis:</p>\n<pre><code>config set notify-keyspace-events AKE\n</code></pre>\n<h2>Redis cli commands</h2>\n<pre><code>set user:1:name 1\nset user:2:name 2\nget user:1:name\nkeys user*\nscan 0\ndel user:1:name 1\nget user:1:name\nflushddb\nset a b ex 10\nget a\nget a\nttl a\nexpire a 60\nset c d exat 1624737950\n</code></pre>\n<h3>xx nx</h3>\n<pre><code>set e f xx\nget e\nset e f nx\nget e\nset e g nx\nget e\n</code></pre>\n<h3>incr</h3>\n<pre><code>set a 1\nincr a\nget a\nflushdb\nincr bb\nkeys *\nget bb\ndecr bb\nget b\nflushdb\nset a 1.02\nget a\nincrbyfloat a .3\nget a\nset sam 100\nincr sam\nincrby sam 20\nincrby sam 20\ndecrby sam 5\n</code></pre>\n<pre><code>set user:1:lives 3 ex 1800\nttl user:1:lives\ndecr user:1:lives\ndecr user:1:lives\ndecr user:1:lives\nflushdb\n</code></pre>\n<h3>Hash</h3>\n<pre><code>hset user:1 name sam age 10 city atlanta\nkeys *\ntype user:1\nhget user:1 name\nhget user:1 age\nhget user:1 city\nhgetall user:1\nhset user:2 birthYear 2020 status active\nexpire user:2 10\nttl user:2*\nkeys *\nhkeys user:1\nhvals user:1\nhexists user:1 status\nhexists user:1 age\nhgetall user:1\nhdel user:1 age\ndel user:1\nkeys *\n</code></pre>\n<h3>List &#x26; Queue</h3>\n<pre><code>rpush users sam mike jake\nkeys *\ntype users\nllen users\nlrange users 0 -1\nlrange users 0 1\nlpop users\nllen users\nrpush 1 2 3 4 5 6\nllen users\nkeys *\nrpush 1 2 3 4 5 6\nlpop users\nlpop users 2\nlrange users 0 -1\n</code></pre>\n<h3>List as lifo stack</h3>\n<pre><code>flushdb\nrpush users 1 2 3 4 5 6\nllen users\nlrange users 0 -1\nrpop users\nrpop users\nrpop users\nllen users\nlrange users 0 -1\nlpush users 4\nkeys *\nlpop users\nlpop users\nlpop users\nkeys *\nllen users\nlpop users\nkeys *\n</code></pre>\n<h3>Set</h3>\n<p>A redis set is an unordered collection of unique items (string)\nsimilar to a Java set.</p>\n<h4>Use cases</h4>\n<ul>\n<li>maintain currently logged in users  </li>\n<li>maintain blacklisted IP address / users  </li>\n<li>set intersection  </li>\n</ul>\n<h4>Basic commands</h4>\n<pre><code>sadd users 1 2 3\nsadd users 4\nsadd users 5\nscard users\nsmembers users\nsadd users 4.5\nsadd users 10\nsmembers users\nsadd users 1\nsmembers users\nsismember users 5\nsismember users 100\nsrem users 100\nsrem users 5\nsismember users 5\nsmembers users\nspop users\nspop users\nscard users\n</code></pre>\n<h4>Set intersection and union</h4>\n<pre><code>flushdb\nsadd skill:java 1 2 3 4\nsadd skill:js 2 3 4\nsadd skill:aws 4 5 6\nsinter skill:java skill:js skill:aws\nsunion skill:java skill js\nsadd candidate:criminal 4 5 6\nsdiff skill:java candidate:criminal\n</code></pre>\n<pre><code>sinterstore java-js skill:java skill:js\nkeys *\nscard java-js\nsmembers java-js\n</code></pre>',id:"/home/nicolas/projects/workshop/src/pages/2021-09-11-redis/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2021-09-11T18:38:00.451Z",path:"/redis",title:"Redis",excerpt:"",tags:["Redis"]}},next:{html:'<h2>Terminology</h2>\n<ul>\n<li>kubernetes / k8s / kube: the whole orchestration system</li>\n<li>kubeclt aka cube control: cli to configure kubernetes and manage apps</li>\n<li>node: single server in the k8s cluster</li>\n<li>kubelet: k8s agent running on nodes</li>\n<li>each kubelet can have a kube-proxy controlling its networking</li>\n<li>control plane aka the "master": set of containers that manage the cluster. Includes api server, scheduler, controller manager, etcd, core DNS and more</li>\n</ul>\n<p>A possible local Kubernetes environment could be composed of the following applications: </p>\n<ul>\n<li>minikube: a local cluster which can be installed and run on your machine. </li>\n<li>kubectl: the interface to interact with the cluster</li>\n<li>k9s: a CLI to monitor and manage your local kubernetes clusters</li>\n</ul>\n<!-- ## Links\n\nKubernetes in a browser:  \n\ntry [http://play-with-k8s.com](http://play-with-k8s.com)\nor [katacoda.com](katacoda.com) in browser -->\n<h1>Local install</h1>\n<p>Follow documentation on <a href="https://minikube.sigs.k8s.io/docs/start/">this page</a> to install minikube locally.</p>\n<p>You can then check your minikube status with: </p>\n<pre><code class="language-bash">minikube status\n</code></pre>\n<p>It can be started if necessary with</p>\n<pre><code class="language-bash">minikube start\n</code></pre>\n<p>Install now kubectl following documentation on <a href="https://kubernetes.io/docs/tasks/tools/install-kubectl-linux/">this page</a>. </p>\n<p>The <a href="https://kubernetes.io/docs/tasks/tools/install-kubectl-linux/#optional-kubectl-configurations-and-plugins">Optional kubectl configurations and plugins</a> can be skipped in a first stage.</p>\n<p>Configuration can be verified with:</p>\n<pre><code class="language-bash">kubectl cluster-info\n</code></pre>\n<p>You can find out the location of your kubectl executable with:</p>\n<pre><code class="language-bash">which kubectl\n</code></pre>\n<p>Download the <code>k9s_Linux_x86_64.tar.gz</code> archive available on\n<a href="https://github.com/derailed/k9s/releases">this page</a> from the k9s github.\nOnce it is extracted, just execute k9s with:</p>\n<pre><code class="language-bash">./k9s\n</code></pre>\n<h2>Pod commands together with a proper example to apply them:</h2>\n<p><code>kubectl get pod</code><br>\nget information about all running pods  </p>\n<p><code>kubectl describe pod &#x3C;pod></code><br>\ndescribe one pod  </p>\n<p><code>kubectl expose pod &#x3C;pod> --port=444 --name=frontend</code><br>\nexpose the port of a pod (creates a new service)  </p>\n<p><code>kubectl port-forward &#x3C;pod> 8080</code><br>\nport forward the exposed pod port to your local machine  </p>\n<p><code>kubectl attach &#x3C;podname> -i</code><br>\nattach to the pod  </p>\n<p><code>kubectl exec &#x3C;pod> -- command</code><br>\nexecute a command on the pod  </p>\n<p><code>kubectl label pods &#x3C;pod> mylabel=awesome</code><br>\nadd a new label to a pod  </p>\n<p><code>kubectl run -i --tty busybox --image=busybox --restart=Never -- sh</code><br>\nrun a shell in a pod  </p>\n<p>With the following example of a pod description\nin a file called <code>helloworld.yml</code>,</p>\n<pre><code class="language-yaml">apiVersion: v1\nkind: Pod\nmetadata:\n  name: nodehelloworld.example.com\n  labels:\n    app: helloworld\nspec:\n  containers:\n  - name: k8s-demo\n    image: wardviaene/k8s-demo\n    ports:\n    - name: nodejs-port\n      containerPort: 3000\n</code></pre>\n<p>The pod can be created with:</p>\n<pre><code class="language-bash">kubectl create -f helloworld.yml\n</code></pre>\n<p>Then, local port 8081 can be forwarded to port 3000 of the pod with:</p>\n<pre><code class="language-bash">kubectl port-forward nodehelloworld.example.com 8081:3000\n</code></pre>\n<p>Or else we can create a service of type NodePort to expose the pod with:</p>\n<pre><code class="language-bash">kubectl expose pod nodehelloworld.example.com --type=NodePort --name nodehelloworld-service\n</code></pre>\n<p>The end point to that service from the local machine can be displayed with:</p>\n<pre><code class="language-bash">minikube service nodehelloworld-service --url\n</code></pre>\n<p>IP addresses of services within the cluster are different. They can be accessed with:</p>\n<pre><code class="language-bash">kubectl get service\n</code></pre>\n<p>It is possible to attach to the pod and watch the possible logs with:</p>\n<pre><code class="language-bash">kubectl attach nodehelloworld.example.com\n</code></pre>\n<p>To execute a command like <code>ls /app</code> run the following line:</p>\n<pre><code class="language-bash">kubectl exec nodehelloworld.example.com -- ls /app\n</code></pre>\n<p>It is instructive to run the two following commands now:</p>\n<pre><code class="language-bash">kubectl exec nodehelloworld.example.com -- touch /app/test.txt\nkubectl exec nodehelloworld.example.com -- ls /app\n</code></pre>\n<p>To operate with a bash prompt in a pod use the following command: </p>\n<pre><code class="language-bash">kubectl exec nodehelloworld.example.com -i -t -- /bin/bash\n</code></pre>\n<p>A description of the pod can be displayed with:</p>\n<pre><code class="language-bash">kubectl describe service nodehelloworld-service\n</code></pre>\n<p>Launch another pod based on the busybox image with:</p>\n<pre><code class="language-bash">kubectl run -i --tty busybox --image=busybox --restart=Never -- sh\n</code></pre>\n<p>Let us assume that the endpoint of our nodehelloworld-service displayed in its description was 172.17.0.2:3000. Then, commands can be executed in the shell of our busybox like:</p>\n<pre><code class="language-bash">ls\ntelnet 172.17.0.2 3000\n</code></pre>\n<p>Pods can finally be deleted with:</p>\n<pre><code class="language-bash">kubectl delete pod busybox\nkubectl delete pod nodehelloworld.example.com\n</code></pre>\n<p>You can also delete the service nodehelloworld-service with:</p>\n<pre><code class="language-bash">kubectl delete service nodehelloworld-service\n</code></pre>\n<h2>Starting a cluster with an nginx container</h2>\n<p>Create a file called <code>deployment.yaml</code> with the following content:</p>\n<pre><code class="language-yaml">apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: nginx-deployment\n  labels:\n    app: nginx\nspec:\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      labels:\n        app: nginx\n    spec:\n      containers:\n      - name: nginx\n        image: nginx:1.21.4\n        ports:\n        - containerPort: 80\n</code></pre>\n<p>Create another file called <code>service.yaml</code> with the following content:</p>\n<pre><code class="language-yaml">apiVersion: v1\nkind: Service\nmetadata:\n  name: nginx-service\n  labels:\n    app: nginx\nspec:\n  selector:\n    app: nginx\n  ports:\n    - protocol: TCP\n      port: 80\n      targetPort: 80\n  type: LoadBalancer\n</code></pre>\n<p>Cluster can now be started with:</p>\n<pre><code class="language-bash">kubectl apply -f deployment.yaml\n</code></pre>\n<p>followed with:</p>\n<pre><code class="language-bash">kubectl apply -f service.yaml\n</code></pre>\n<p>To display services execute:</p>\n<pre><code class="language-bash">kubectl get services\n</code></pre>\n<p>The following command is an interesting one to run now:</p>\n<pre><code class="language-bash">minikube service nginx-service\n</code></pre>\n<p>since it displays the url of the nginx-service and opens the latter\nservice in your default browser.</p>\n<p>To display namespaces execute:</p>\n<pre><code class="language-bash">kubectl get namespaces\n</code></pre>\n<p>To find out the namespace where pods have been created you can run this command:</p>\n<pre><code class="language-bash">kubectl get pods --all-namespaces\n</code></pre>\n<p>To stop one of the pods displayed whose name is for instance <code>hello-minikube-6ddfcc9757-h4ctx</code>\nexecute the following command:</p>\n<pre><code class="language-bash">kubectl delete -n default pod hello-minikube-6ddfcc9757-h4ctx\n</code></pre>\n<p>To display deployments currently running execute:</p>\n<pre><code class="language-bash">kubectl get deployments\n</code></pre>\n<p>To delete a service first display all of your services with:</p>\n<pre><code class="language-bash">kubectl get service -o wide\n</code></pre>\n<p>You can now pick the one you wish to delete from the displayed list\n--- for instance nginx-service --- and then delete it with:</p>\n<pre><code class="language-bash">kubectl delete service nginx-service\n</code></pre>\n<p>Delete deployment nginx-deployment with:</p>\n<pre><code class="language-bash">delete deployment nginx-deployment\n</code></pre>\n<h2>Minikube example</h2>\n<pre><code class="language-bash">kubectl create deployment hello-minikube --image=k8s.gcr.io/echoserver:1.4\n</code></pre>\n<pre><code class="language-bash">kubectl expose deployment hello-minikube --type=NodePort --port=8080\n</code></pre>\n<pre><code class="language-bash">minikube service hello-minikube\n</code></pre>\n<pre><code class="language-bash">kubectl delete deployment hello-minikube\n</code></pre>\n<pre><code class="language-bash">minikube stop\n</code></pre>\n<p>The minikube vm can optionally be completely reset with:</p>\n<pre><code class="language-bash">minikube delete\n</code></pre>\n<p>After this, Minikube will start from scratch the next time it is started.</p>\n<h2>Advanced topics</h2>\n<h4>Service discovery</h4>\n<pre><code class="language-zsh">kubectl run -i --tty busybox --image=busybox --restart=Never -- sh\n</code></pre>\n<pre><code class="language-sh">cat /etc/resolv.conf\n</code></pre>\n<pre><code class="language-zsh">kubectl exec database -i -t -- mysql -u root -p\n</code></pre>\n<h4>ConfigMap</h4>\n<pre><code class="language-sh">kubectl create configmap app-config --fromfile=app.properties\n</code></pre>\n<h4>Ingress Controller</h4>\n<h4>External DNS</h4>\n<h4>Volumes</h4>\n<h4>K9S</h4>\n<pre><code class="language-sh">k9s help\n</code></pre>\n<pre><code class="language-sh">k9s -n my-namespace\n</code></pre>\n<p>The : mode --- typing : followed with a kubernetes concept:</p>\n<pre><code class="language-sh">:ns\n:pod\n:svc\n:deploy\n:ing\n:crd\n:pulse\n:popeye\n:xray\n</code></pre>\n<p><code>popeye</code>  displays score card for the cluster. Takes one to the sanitizer.</p>\n<p><code>xray pod default</code> brings up windows like file explorer for folder structure navigation</p>\n<p>The / mode for filtering --- example:</p>\n<p><code>/ followed with -l version=v2</code> filters by labels version of v2</p>\n<p>Killing a pod can be done with ctrl + d</p>',id:"/home/nicolas/projects/workshop/src/pages/2021-11-25-kubernetes/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2021-11-25T10:17:00.823Z",path:"/kubernetes",title:"Kubernetes",excerpt:"",tags:["kubernetes","cloud","devops"]}}}}}});
//# sourceMappingURL=path---project-reactor-38d9e7423826d648cd08.js.map